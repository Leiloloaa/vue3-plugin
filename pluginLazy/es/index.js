import{Lazyload as i}from"vant";import l from"./Lazy.vue_vue_type_script_setup_true_lang.js";const m=(()=>{try{return document.createElement("canvas").toDataURL("image/webp",.5).startsWith("data:image/webp")}catch{return!1}})(),a="?x-oss-process=image/format,webp/quality,Q_80",n=e=>m&&/webp$/.test(e.value)&&e.modifiers.webp;function v(e,t){const r=()=>{console.info("\u56FE\u7247\u62A5\u9519\u4E86===",t.value),e.src=t.value,e.removeEventListener("error",r)};e._hasLazyListener||(e.addEventListener("error",r),e._hasLazyListener=!0),e.src=n(t)?t.value+a:t.value}function y(e,t){e.style.backgroundImage=`url('${n(t)?t.value+a:t.value}')`,e.style.backgroundSize="100% 100%"}function s(e,t){return t.modifiers.bg?y(e,t):v(e,t)}const d={beforeMount(e,t){e._hasLazyListener=!1;function r(){const o=new IntersectionObserver((c,u)=>{c.forEach(f=>{f.isIntersecting&&(s(e,t),u.unobserve(e))})},{threshold:0});o==null||o.observe(e)}window.IntersectionObserver?r():s(e,t)},updated(e,t){s(e,t)}},L=e=>{e.use(i,{lazyComponent:!0}),e._context.directives.lazy&&delete e._context.directives.lazy,e.directive("lazy",d),e.component("Lazy",l)};export{L as default,d as lazyBody};
